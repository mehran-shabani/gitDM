# GitDM โ ุณุงูุงูู ูุฏุฑุช ุฏุงุจุช (Django + DRF)

GitDM ฺฉ ุณุงูุงููู ูุฏุฑุช ู ูุณุฎูโุจูุฏ ุฏุงุฏูโูุง ุจูุงุฑุงู ุฏุงุจุช ุงุณุช ฺฉู ุจุฑ ูพุงูู Django 5 ู Django REST Framework ุณุงุฎุชู ุดุฏู ู ุฏุงุฑุง ูุณุชูุฏุณุงุฒ OpenAPIุ ุงุญุฑุงุฒ ููุช JWT ู ุฒุฑุณุงูุงููโูุง ููุงุฌูู ุจุงููุ ุขุฒูุงุดฺฏุงูุ ูุณุฎูโูุง ุฏุงุฑูุ ูุฑุงุฌุน ุจุงูู ู ุฎูุงุตูโุณุงุฒ ููุดโูุตููุน ุงุณุช.

ุงู ุณูุฏ ูุฑุฌุน ูุงุญุฏ ูุฎุฒู ุงุณุช ู ุชูุงู ุงูฺฉุงูุงุชุ ุฑุงูโุงูุฏุงุฒ ู APIูุง ุฑุง ูพูุดุด ูโุฏูุฏ.

## ๐ ุดุฑูุน ุณุฑุน

- ุงุฌุฑุง ุจุง Docker (ุชูุตูโุดุฏู ุจุฑุง ุชูุณุนู):
  1) ูุงู ูุญุท ุฑุง ุฏุฑ ุตูุฑุช ูุงุฒ ุงุฌุงุฏ ฺฉูุฏ: `cp .env.example .env` (ุฏุฑ ุตูุฑุช ููุฌูุฏ ุจูุฏู)
  2) ุงุณฺฉุฑูพุช ุจูุชโุงุณุชุฑูพ: `./bootstrap.sh`
  3) ุจุฑูุงูู ุฏุฑ `http://localhost:8000` ุฏุฑ ุฏุณุชุฑุณ ุงุณุช
  4) ุงุทูุงุนุงุช ูพุดโูุฑุถ ูุญุท ุชูุณุนู:
     - Django Admin: ฺฉุงุฑุจุฑ `admin` ุจุง ฺฏุฐุฑูุงฺูู `admin123` (ุฏุฑ ุตูุฑุช ูุจูุฏุ ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุณุงุฎุชู ูโุดูุฏ)

- ุงุฌุฑุง ุฑู GitHub Codespaces:
  - ูพุณ ุงุฒ ุจุงุฒ ุดุฏู Codespaceุ ุฑุงูโุงูุฏุงุฒ ุฎูุฏฺฉุงุฑ ุงูุฌุงู ูโุดูุฏ (SQLiteุ ููุงุฌุฑุชโูุงุ ุฌูุนโุขูุฑ ูุงูโูุง ุงุณุชุงุชฺฉ). ุขุฏุฑุณ ุงุฒ ุทุฑู ูพูุฑุช ููุฑูุงุฑุฏ ุดุฏูู 8000 ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

- ุงุฌุฑุง ูุญู ุจุฏูู Docker:
  1) ุณุงุฎุช ู ูุนุงูโุณุงุฒ ูุญุท ูุฌุงุฒ: `python -m venv .venv && source .venv/bin/activate`
  2) ูุตุจ ูุงุจุณุชฺฏโูุง: `pip install -r requirements.txt`
  3) ุงุฌุงุฏ ูุงู `.env` (ุฏุฑ ุตูุฑุช ูุงุฒ)
  4) ููุงุฌุฑุช ุฏุชุงุจุณ: `python manage.py migrate`
  5) ุงุฌุฑุง: `python manage.py runserver`

### ูุชุบุฑูุง ูุญุท ููููู

ูุงู ูููููู ุฒุฑ ุจุฑุง ูุญุทโูุง ุฎุงุฑุฌ ุงุฒ Codespaces ูพุดููุงุฏ ูโุดูุฏ:

```python
# Django
DJANGO_SECRET_KEY=your-secret-key-here
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1

# ูพุงฺฏุงูโุฏุงุฏู ุจุฑูู (ุงุฎุชุงุฑ)
POSTGRES_DB=diabetes
POSTGRES_USER=diabetes
POSTGRES_PASSWORD=your-postgres-password
POSTGRES_HOST=your-postgres-host
POSTGRES_PORT=5432

# Redis (ุงุฎุชุงุฑ)
REDIS_URL=redis://your-redis-host:6379/0

# MinIO (ุงุฎุชุงุฑ)
MINIO_ENDPOINT=your-minio-host:9000
MINIO_ACCESS_KEY=your-minio-access-key
MINIO_SECRET_KEY=your-minio-secret-key
MINIO_USE_HTTPS=False
MINIO_MEDIA_BUCKET=media
MINIO_STATIC_BUCKET=static
```

ุฏุฑ ุญุงูุช Codespacesุ ุจูโุตูุฑุช ูพุดโูุฑุถ ุงุฒ SQLite ู ูุงูโุณุณุชู ูุญู ุงุณุชูุงุฏู ูโุดูุฏ ู Celery ุบุฑูุนุงู ุงุณุช.

## ๐ ูุณุชูุฏุงุช API ู ููุงุท ุฏุณุชุฑุณ

- Swagger UI: `/api/docs/`
- ReDoc: `/api/redoc/`
- OpenAPI Schema (JSON): `/api/schema/`
- Health Check: `/health/`
- ุฑุดูู API: `/api/` (ูุถุนุช ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ)

### ุงุญุฑุงุฒ ููุช (JWT)

- ุฏุฑุงูุช ุชูฺฉู ุฏุณุชุฑุณ/ููุณุงุฒ: `POST /api/token/`
- ููุณุงุฒ ุชูฺฉู: `POST /api/token/refresh/`

ููููู ุฏุฑุฎูุงุณุช ุฏุฑุงูุช ุชูฺฉู:

```bash
curl -X POST http://localhost:8000/api/token/ \
  -H 'Content-Type: application/json' \
  -d '{"email": "user@example.com", "password": "pass"}'
```

ุฏุฑุฎูุงุณุชโูุง ูุญุงูุธุชโุดุฏู ุจุงุฏ ูุฏุฑ ุฒุฑ ุฑุง ุฏุงุดุชู ุจุงุดูุฏ:

```bash
Authorization: Bearer <ACCESS_TOKEN>
```

ุงุฏุฏุงุดุช: ุฏุฑ ูุงฺูู ูุณุฑูุง ุจุฑุง ุณุงุฒฺฏุงุฑุ ูุณุฑูุง ุฌุงฺฏุฒู ุฏฺฏุฑ ูู ูุฌูุฏ ุฏุงุฑูุฏุ ูู ูุณุฑูุง ุจุงูุง ูุฑุฌุน ุงุตูโุงูุฏ.

### ููุงุจุน ุงุตู (ViewSetูุง)

ูพุดููุฏ ูููู ูุณุฑูุง ุฒุฑ `/api/` ุงุณุช.

- ุจูุงุฑุงู (`patients`): CRUD ู ุชุงูโูุงู
  - `GET /patients/` ููุฑุณุช ุจูุงุฑุงู (ูุญุฏูุฏ ุจู ุฏุณุชุฑุณ ฺฉุงุฑุจุฑ)
  - `POST /patients/` ุงุฌุงุฏ ุจูุงุฑ ุฌุฏุฏ (ูพุฒุดฺฉ ูุนู ุจูโุนููุงู `primary_doctor` ุซุจุช ูโุดูุฏ)
  - `GET /patients/{id}/` ูุดุงูุฏูู ุฌุฒุฆุงุช
  - `PUT/PATCH /patients/{id}/` ุจูโุฑูุฒุฑุณุงู
  - `DELETE /patients/{id}/` ุญุฐู
  - ุงฺฉุดูโูุง:
    - `GET /patients/{id}/timeline/` ุจุงุฒฺฏุฑุฏุงูุฏู ุชุงูโูุงู ุชุฌูุนโุดุฏูู ุจูุงุฑ
      - ูพุงุฑุงูุชุฑ ุงุฎุชุงุฑ: `?limit=100` (ุญุฏุงฺฉุซุฑ 500)

- ููุงุฌููโูุง (`encounters`): CRUD
  - `GET /encounters/`
  - `POST /encounters/` (ููุฏ `created_by` ุฎูุฏฺฉุงุฑ ุงุฒ ฺฉุงุฑุจุฑ ุฌุงุฑ ุชูุธู ูโุดูุฏ)
  - `GET /encounters/{id}/`
  - `PUT/PATCH /encounters/{id}/`
  - `DELETE /encounters/{id}/`

- ูุชุงุฌ ุขุฒูุงุดฺฏุงู (`labs`): CRUD
  - `GET /labs/`
  - `POST /labs/`
  - `GET /labs/{id}/`
  - `PUT/PATCH /labs/{id}/`
  - `DELETE /labs/{id}/`

- ุฏุณุชูุฑุงุช ุฏุงุฑู (`meds`): CRUD
  - `GET /meds/`
  - `POST /meds/`
  - `GET /meds/{id}/`
  - `PUT/PATCH /meds/{id}/`
  - `DELETE /meds/{id}/`

- ููุงุจุน ูุฑุฌุน ุจุงูู (`refs`): CRUD
  - `GET /refs/`
  - `POST /refs/`
  - `GET /refs/{id}/`
  - `PUT/PATCH /refs/{id}/`
  - `DELETE /refs/{id}/`

- ุฎูุงุตูโูุง ููุดโูุตููุน (`ai-summaries`)
  - `GET /ai-summaries/` ููุฑุณุช (ุจุง ุงูฺฉุงู ููุชุฑ `?patient_id=<uuid>`)
  - `POST /ai-summaries/` ุงุฌุงุฏ (ุทุจู ุชูุธูุงุช OpenAI/GapGPTุ ููฺฉู ุงุณุช ููุฒูุงู/ูุงููุฒูุงู ุจุฑฺฏุฑุฏุฏ)
  - `GET /ai-summaries/{id}/` ูุดุงูุฏูู ุฎูุงุตู
  - `DELETE /ai-summaries/{id}/` ุญุฐู
  - ุงฺฉุดูโูุง:
    - `POST /ai-summaries/{id}/regenerate/` ุจุงุฒุชููุฏ ุฎูุงุตู (ูุงููุฒูุงู)
    - `POST /ai-summaries/test/` ุชุณุช ุงุชุตุงู ุณุฑูุณ AI
    - `GET /ai-summaries/stats/` ุขูุงุฑ ฺฉู ุฎูุงุตูโูุง
    - `POST /ai-summaries/test-references/` ุชุณุช ููฺฉโุณุงุฒ ูุฑุงุฌุน ุจุงูู

- ุชุดุฎุต ุงูฺฏููุง ุบุฑุทุจุน (`pattern-analyses`, `anomaly-detections`, `pattern-alerts`, `baseline-metrics`)
  - `GET /pattern-analyses/` ููุฑุณุช ุชุญููโูุง ุงูฺฏู
  - `POST /pattern-analyses/analyze/` ุฏุฑุฎูุงุณุช ุชุญูู ุฌุฏุฏ
  - `GET /anomaly-detections/` ููุฑุณุช ูุงููุฌุงุฑโูุง ุชุดุฎุต ุฏุงุฏู ุดุฏู
  - `POST /anomaly-detections/{id}/acknowledge/` ุชุงุฏ ูุงููุฌุงุฑ
  - `GET /pattern-alerts/` ููุฑุณุช ูุดุฏุงุฑูุง ุงูฺฏู
  - `POST /pattern-alerts/{id}/resolve/` ุญู ูุดุฏุงุฑ
  - `GET /baseline-metrics/` ูุนุงุฑูุง ูพุงู ุจูุงุฑุงู
  - `POST /baseline-metrics/calculate/` ูุญุงุณุจู ูุนุงุฑูุง ูพุงู

- ูุณุฎูโุจูุฏ ุชุบุฑุงุช (`versions`)
  - `GET /versions/{resource_type}/{resource_id}/` ููุฑุณุช ูุณุฎูโูุง (ุฎุฑูุฌ: ุขุฑุงูโุง ุงุฒ ูุณุฎูโูุง)
  - `POST /versions/{resource_type}/{resource_id}/revert/` ุจุงุฒฺฏุฑุฏุงู ุจู ูุณุฎูู ูุดุฎุต
    - ุจุฏูู: `{ "target_version": <int> }`

- ุฎุฑูุฌโฺฏุฑูุชู ุฏุงุฏูู ุจูุงุฑ (Export)
  - `GET /export/patient/{id}/` ุจุงุฒฺฏุดุช ุณุงุฎุชุงุฑ ูพุงู ุดุงูู ุจูุงุฑ ู ุขุฑุงูโูุง encounters/labs/medications/ai_summaries

### ูููููู ฺฏุฑุฏุด ุงุญุฑุงุฒ ููุช ู ุงุฌุงุฏ ุจูุงุฑ

```bash
# ุงุฌุงุฏ ฺฉุงุฑุจุฑ ู ุฏุฑุงูุช ุชูฺฉู (ูุซุงู)
curl -X POST http://localhost:8000/api/token/ \
  -H 'Content-Type: application/json' \
  -d '{"email":"u1@test.com","password":"p1"}'

# ุงุณุชูุงุฏู ุงุฒ ุชูฺฉู ุจุฑุง ุงุฌุงุฏ ุจูุงุฑ
curl -X POST http://localhost:8000/api/patients/ \
  -H 'Authorization: Bearer <TOKEN>' \
  -H 'Content-Type: application/json' \
  -d '{"full_name":"Ali Test"}'

# ูุดุงูุฏูู ุชุงูโูุงู
curl -H 'Authorization: Bearer <TOKEN>' \
  http://localhost:8000/api/patients/<PID>/timeline/
```

## โ๏ธ ุฑุงูโุงูุฏุงุฒ ู ุงุฌุฑุง

- Docker Compose: ฺฉ ุณุฑูุณ `web` ุงุฌุฑุง ูโุดูุฏ ฺฉู ูุณุฆูู ููุงุฌุฑุช ุฏุชุงุจุณุ ุฌูุนโุขูุฑ ูุงูโูุง ุงุณุชุงุชฺฉ ู ุงุฌุฑุง ุณุฑูุฑ ุชูุณุนู ุงุณุช. ุงุณฺฉุฑูพุช `bootstrap.sh` ุงู ูุฑุงุญู ุฑุง ุฎูุฏฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ ู ุฏุฑ ุตูุฑุช ูุจูุฏุ ุงุฏูู ูพุดโูุฑุถ ูโุณุงุฒุฏ.

- ุชูุธูุงุช ููู ุฏุฑ `config/settings.py`:
  - `REST_FRAMEWORK`: ุงุญุฑุงุฒ ููุช JWTุ ูุฌูุฒ ูพุดโูุฑุถ `IsAuthenticated`ุ ู `drf_spectacular` ุจุฑุง ุทุฑุญโูุงุฑู OpenAPI
  - `SIMPLE_JWT`: ุทูู ุนูุฑ ุชูฺฉูโูุงุ ุงูฺฏูุฑุชู ู ููุน ูุฏุฑ
  - ฺฉูุฏูุง AI: `GAPGPT_API_KEY`, `OPENAI_API_KEY` (ุงุฎุชุงุฑ)

## ๐งช ุชุณุชโูุง

- ุงุฌุฑุง ุชุณุชโูุง: `pytest -v`
- ุชุณุชโูุง ุดุงูู ุจุฑุฑุณ ูุณุฑูุง API (health/schema/docs)ุ JWTุ ุงูุฏูพููุชโูุง ูุณุฎูโุจูุฏ ู ุฌุฑุงูโูุง ูพุงู ุงุณุช.

## ๐ ุณุงุฎุชุงุฑ ูพุฑูฺู (ุฎูุงุตู)

```bash
config/        ุชูุธูุงุช ูพุฑูฺู ู URLูุง
gateway/       ุซุจุช ุฑูุชุฑูุง ู ุงูุฏูพููุชโูุง ุณุทุญ ุฑุดูู API
gitdm/         ุฏุงูููู ุงุตู (ฺฉุงุฑุจุฑ/ุจูุงุฑ) ู ViewSetูุง ูุฑุชุจุท
encounters/    ููุงุฌููโูุง ุจุงูู
intelligence/  ุฎูุงุตูโุณุงุฒ ูุจุชู ุจุฑ AI ู ุงฺฉุดูโูุง ูุฑุชุจุท
laboratory/    ูุชุงุฌ ุขุฒูุงุดฺฏุงู
pharmacy/      ุฏุณุชูุฑุงุช ุฏุงุฑู
references/    ูุฑุงุฌุน ุจุงูู
versioning/    API ูุณุฎูโุจูุฏ ุชุบุฑุงุช ุฑฺฉูุฑุฏูุง
security/      ุงุฌุฒุง ุงููุช/ุงุฏูู
tests/         ูุฌููุนูู ุชุณุช (pytest / pytest-django)
```

## ๐ ูุฌูุฒ

ุงู ูพุฑูฺู ุชุญุช ูุฌูุฒ ููุฌูุฏ ุฏุฑ ูุงู `LICENSE` ููุชุดุฑ ุดุฏู ุงุณุช.

## ๐ค ูุดุงุฑฺฉุช ุฏุฑ ุชูุณุนู

- ุชุณุชโูุง ุฑุง ูพุด ุงุฒ ุงุฑุณุงู PR ุงุฌุฑุง ฺฉูุฏ: `pytest -v`
- ูพุงูโูุง ฺฉุงูุช ฺฉูุชุงู ู ุดูุงู ุจุงุดูุฏุ PRูุง ูุชูุฑฺฉุฒ ู ฺฉูฺฺฉ ุงุฑุณุงู ุดููุฏ.
